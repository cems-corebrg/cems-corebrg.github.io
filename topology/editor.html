<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>CeMS Topology editor</title>
        <style>

@import "/css/style.css";
@import "/css/fa.css";

body {
    position: fixed; inset: 0 0 0 0;
    padding: 0; margin: 0;
    background-color: #0000005f;
}

iframe {
    width: 100%; height: 100%;
    border: none;
}

/** control **/
nav {
    position: absolute; inset: 5px 5px auto 5px;
    display: flex; justify-content: space-between;
    font: 20px "Font Awesome 5 Free";
    color: #ffffff;
    user-select: none;
    pointer-events: none;
}

nav >div {
    display: flex;
}

nav span {
    border-radius: 50%;
    display: flex; width: 32px; height: 32px;
    align-items: center;
    justify-content: center;
    background-color: rgba(0, 132, 255, 0.5);
    border-color: #0084ff;
    cursor: pointer;
    pointer-events: all;
}

nav span:hover {
    background-color: #0084ff;
}


nav img {
	width: 30px; height: 30px;
	display: inline-block;
	border-radius: 5px;
    border: 1px solid #e3b778;
	background-color:#ffffed;
	box-shadow: 0 4px 0 #dddddd;
	transform: translate3d(0px, -4px, 0px);
    cursor: pointer;
    pointer-events: all;
}

nav img:active {
	box-shadow: none;
	transform: translate3d(0px, 0px, 0px);
	transition: 0.1s ease-in-out;
}

			</style>            
        </head>
        
        <script>

function showMessage(xhr) {
    if (xhr instanceof XMLHttpRequest) {
        switch (xhr.status) {
        case 401:
            alert(NOTICE_SESS_EXPIRE["kr"]);

            break;
        default:
            alert(ERROR_RES_CODE(xhr.status)["kr"]);
        }

        try {
            console.log(JSON.parse(xhr.responseText).error);
        } catch (e) {}
    } else if (xhr instanceof Error) {
        console.error(xhr);
    } else {
        console.trace();
    }
}

        </script>

        <body>
            <nav>
                <div></div>
                <div>
                    <img src="/img/button/close.png" title="편집 종료" id="close">
                </div>
            </nav>
            <iframe id="frame"></iframe>

        <script src="/js/request.js"></script>
        <script src="/js/constants.js"></script>
        <script type="module">
import Channel from "../js/module/channel.js";

Channel.request("account", account => {
    if (account.level !== 0) {
        throw "권한 없음";
    }

    var positionData;

    document.getElementById("close").onclick = e => window.location.replace("/topology/viewer.html");

    new Request().query({
        command: "get",
        target: "position",
        position: {
            name: "position"
        }
    }).then(positionData => {
        window.positionData = positionData || {};

        document.getElementById("frame").src = "/topology/tool.html";
    }).catch(showMessage);
});

        </script>
    </body>
</html>